If(
    varEmailSent ||
    !IsMatch(
        Trim(txtTo.Value),
        "^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$",
        MatchOptions.IgnoreCase
    ),
    DisplayMode.Disabled,
    DisplayMode.Edit
)
